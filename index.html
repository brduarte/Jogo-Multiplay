<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Jogo Multiplay</title>
    <script src="/socket.io/socket.io.js"></script>
</head>

<style>
    .container {
        display: flex;
        width: 50%;
        margin-left: auto;
        margin-right: auto;
        justify-content: center;
    }

    #canvas {
        image-rendering: crisp-edges;
        image-rendering: optimizeQuality;
        border: 4px solid whitesmoke;
    }
</style>

<body>

    <div class="container">
        <canvas id="canvas" width="500px" height="500px"></canvas>
    </div>


    <script>

        const socket = io();
        var jogo;

        const canvas = document.getElementById('canvas');
        const context = canvas.getContext('2d');



        socket.on('connect', function () {
            console.log('Jogador conectado.');
        });

        socket.on('configuracaoes-jogo', function (configuracoes) {
            jogo = configuracoes;
            console.log(jogo.jogadores)
            renderJogo();

        });



        function renderJogo() {

            context.fillStyle = 'white';
            context.fillRect(0, 0, 500, 500);

            for (const idFrutinha in jogo.frutinhas) {
                const frutinha = jogo.frutinhas[idFrutinha];
                context.fillStyle = jogo.configuracoes.corFrutinha;
                context.fillRect(frutinha.x, frutinha.y, jogo.configuracoes.tamanhoObjs.width, jogo.configuracoes.tamanhoObjs.height);
            }

            for (const idJogador in jogo.jogadores) {

                const jogador = jogo.jogadores[idJogador];
                context.fillStyle = jogo.configuracoes.corJogadores;
                context.fillRect(jogador.cordenadas.x, jogador.cordenadas.y, jogo.configuracoes.tamanhoObjs.width, jogo.configuracoes.tamanhoObjs.height);

            }

            requestAnimationFrame(renderJogo);

        }


        function controle(jogador) {

            const keyCode = event.keyCode

            switch (keyCode) {
                case 37: //esquerda
                    jogador.x -= 10
                    break;
                case 38: //cima
                    jogador.y -= 10
                    break;
                case 39: //direita
                    jogador.x += 10
                    break;
                case 40: //baixo
                    jogador.y += 10
                    break;
                default:
                    break;
            }

        }


    </script>

</body>

</html>